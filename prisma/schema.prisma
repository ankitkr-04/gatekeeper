// schema.prisma

datasource db {
  provider = "postgresql" // or "mysql", "sqlite" based on your setup
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Museum {
  id          String       @id @default(uuid())
  name        String
  location    Location?
  description String?
  ticketTypes TicketType[]
  bookings    Booking[]
}

model Location {
  id       String  @id @default(uuid())
  address  String
  city     String
  state    String
  country  String
  zipCode  String
  museum   Museum  @relation(fields: [museumId], references: [id])
  museumId String  @unique
}

model TicketType {
  id         String    @id @default(uuid())
  type       String    // e.g., individual, group, etc.
  childCost  Float?    // Cost per child
  adultCost  Float?    // Cost per adult
  seniorCost Float?    // Cost per senior
  museum     Museum    @relation(fields: [museumId], references: [id])
  museumId   String
  bookings   Booking[]
}

model Booking {
  id             String        @id @default(uuid())
  museum         Museum        @relation(fields: [museumId], references: [id])
  museumId       String
  ticketType     TicketType    @relation(fields: [ticketTypeId], references: [id])
  ticketTypeId   String
  numOfAdults    Int
  numOfChildren  Int
  numOfSeniors   Int
  totalPrice     Float
  status         PaymentStatus
  orderId        String        @unique
  paymentChannel String
  transactionId  String?
  ticket         Ticket?
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
}

model Ticket {
  id        String       @id @default(uuid())
  booking   Booking      @relation(fields: [bookingId], references: [id])
  bookingId String       @unique
  barcodeNo String       @unique
  status    TicketStatus
  visitDate DateTime
  bookedBy  String
  email     String
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt
}

enum PaymentStatus {
  PENDING
  COMPLETED
  FAILED
  CANCELLED
}

enum TicketStatus {
  BOOKED
  USED
  CANCELLED
}